version: 2

sources:
  - name: ca_google_analytics
    database: "{{ env_var('DBT_RAW_DB', 'RAW_PRD') }}"
    schema: ca_google_analytics
    tables:
      - name: ANALYTICS_314711183
        description: ""
        freshness:
          warn_after:
            count: 3
            period: day
          error_after:
            count: 5
            period: day
          filter: datediff('day', source_table_date, current_timestamp) < 5
        loaded_at_field: "source_table_date::timestamp"

      - name: ANALYTICS_322878501
        description: ""
        freshness:
          warn_after:
            count: 3
            period: day
          error_after:
            count: 5
            period: day
          filter: datediff('day', source_table_date, current_timestamp) < 5
        loaded_at_field: "source_table_date::timestamp"
